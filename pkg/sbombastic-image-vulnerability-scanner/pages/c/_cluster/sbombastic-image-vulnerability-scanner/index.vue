<script>
import Dashboard from '@pkg/pages/c/_cluster/sbombastic-image-vulnerability-scanner/Dashboard';
import { SERVICE, SCHEMA } from '@shell/config/types';
import { RESOURCE } from '@pkg/types';
import InstallView3 from '@pkg/components/InstallView3';

export default {
  name: 'Entry',

  components: { Dashboard, InstallView3 },

  async fetch() {
    console.log("Entry fetch")
    if ( this.$store.getters['cluster/canList'](SERVICE) ) {
      this.allServices = await this.$store.dispatch('cluster/findAll', { type: SERVICE }, { root: true });
    }
    if ( this.$store.getters['cluster/canList'](SCHEMA) ) {
      this.allSchemas = await this.$store.dispatch('cluster/findAll', { type: SCHEMA }, { root: true });
    }
  },

  data() {
    return {
      allServices: null,
      allSchemas: null,
      index: -1,
      store: this.$store,
    }
  },

  computed: {
    hasSchema() {
      return this.$store.getters['cluster/schemaFor'](RESOURCE.REGISTRY);
    },
  }
};
</script>

<template>
  <div v-if="allSchemas">
    <!-- <InstallView3 /> -->
    <InstallView3 v-if="!hasSchema" />
    <Dashboard v-else/>
  </div>
</template>
