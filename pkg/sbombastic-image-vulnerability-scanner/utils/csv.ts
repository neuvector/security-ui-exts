import { ImageVulnerability } from "@pkg/types";

export function imageDetailsToCSV(vuls: ImageVulnerability[]): Object[] {
  return vuls.map((vul) => {
    return {
      CVE_ID: vul.cve,
      SCORE: vul.cvss?.["nvd"]?.v3score || "",
      PACKAGE: vul.packageName,
      "FIX AVAILABLE": vul.fixedVersions[0],
      SEVERITY: vul.severity,
      EXPLOITABILITY: vul.suppressed,
      "PACKAGE VERSION": vul.installedVersion,
      "PACKAGE PATH": vul.purl,
      DESCRIPTION: vul.description.replace(/[\r\n]+/g, " "),
    };
  });
}
