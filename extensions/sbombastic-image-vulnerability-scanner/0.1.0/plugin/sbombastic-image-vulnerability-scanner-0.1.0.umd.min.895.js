(("undefined"!==typeof self?self:this)["webpackChunksbombastic_image_vulnerability_scanner_0_1_0"]=("undefined"!==typeof self?self:this)["webpackChunksbombastic_image_vulnerability_scanner_0_1_0"]||[]).push([[895],{3367:function(e,t,s){"use strict";s.r(t);var o=s(36758),a=s.n(o),r=s(40935),i=s.n(r),l=i()(a());l.push([e.id,".cru-resource-footer{display:flex;justify-content:flex-end;margin-top:20px;z-index:19}.cru-resource-footer .btn{margin-left:20px}",""]),t["default"]=l},10852:function(e,t,s){var o=s(46820);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(74825).A;a("05deb7da",o,!0,{sourceMap:!1,shadowMode:!1})},14384:function(e,t,s){"use strict";s.d(t,{A:function(){return le}});var o=s(9274);const a={class:"cru"},r={key:0,class:"description"},i={key:0,id:"cru-errors",class:"cru__errors"},l={key:1,class:"subtypes-container cru__content"},n=["data-testid","aria-label","onClick","onKeyup"],c={class:"subtype-container"},d={class:"subtype-logo"},u=["src","alt"],p={key:1,class:"round-image"},h={key:0,class:"banner-abbrv"},m={key:0},y={key:1},f={class:"subtype-body"},b={key:0},k={key:1},v=["href"],w={key:0,role:"none"},g={key:1,class:"description"},S={key:0},C={key:1},B={key:0,class:"resource-container cru__content cru__content-wizard"},E={class:"controls-steps"},_=["onClick"],N=["disabled","onClick"],A=["data-testid"],$={key:4,class:"cru-resource-yaml-container resource-container cru__content"},x={class:"controls-middle"},K=["data-testid","onClick"],V=["data-testid","disabled","onClick"],Y={key:0,class:"controls-right"},H=["data-testid","onClick"];function R(e,t,s,R,O,T){const D=(0,o.resolveComponent)("Banner"),F=(0,o.resolveComponent)("t"),j=(0,o.resolveComponent)("AsyncButton"),I=(0,o.resolveComponent)("CruResourceFooter"),M=(0,o.resolveComponent)("Wizard"),L=(0,o.resolveComponent)("ResourceYaml"),z=(0,o.resolveDirective)("clean-html");return(0,o.openBlock)(),(0,o.createElementBlock)("section",a,[(0,o.renderSlot)(e.$slots,"noticeBanner",{},void 0,!0),s.description?((0,o.openBlock)(),(0,o.createElementBlock)("p",r,(0,o.toDisplayString)(s.description),1)):(0,o.createCommentVNode)("",!0),((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(T.isView?"div":"form"),{value:s.resource,"data-testid":"cru-form",class:"create-resource-container cru__form",onSubmit:t[6]||(t[6]=(0,o.withModifiers)((()=>{}),["prevent"])),onKeydown:t[7]||(t[7]=(0,o.withKeys)((e=>T.onPressEnter(e)),["enter"]))},{default:(0,o.withCtx)((()=>[T.hasErrors?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.errors,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(D,{key:t,color:"error","data-testid":`error-banner${t}`,label:T.stringify(T.mappedErrors[e].message),icon:T.mappedErrors[e].icon,closable:!0,onClose:e=>T.closeError(t)},null,8,["data-testid","label","icon","onClose"])))),128))])):(0,o.createCommentVNode)("",!0),T.showSubtypeSelection?((0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.renderSlot)(e.$slots,"subtypes",{subtypes:s.subtypes},(()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.subtypes,((a,r)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:r,class:(0,o.normalizeClass)(["subtype-banner",{selected:a.id===T._selectedSubtype}]),"data-testid":`subtype-banner-item-${a.id}`,tabindex:"0","aria-disabled":!1,"aria-label":a.description?`${a.label} - ${a.description}`:a.label,role:"link",onClick:e=>T.selectType(a.id,e),onKeyup:(0,o.withKeys)((e=>T.selectType(a.id,e)),["enter","space"])},[(0,o.renderSlot)(e.$slots,"subtype-content",{},(()=>[(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",d,[a.bannerImage?((0,o.openBlock)(),(0,o.createElementBlock)("img",{key:0,src:a.bannerImage,alt:(s.resource.type?s.resource.type+": ":"")+(a.label||"")},null,8,u)):((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[a.bannerAbbrv?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[e.$store.getters["i18n/exists"](a.bannerAbbrv)?((0,o.openBlock)(),(0,o.createElementBlock)("span",m,(0,o.toDisplayString)(e.t(a.bannerAbbrv)),1)):((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:1,style:(0,o.normalizeStyle)({fontSize:O.abbrSizes[a.bannerAbbrv.length]})},(0,o.toDisplayString)(a.bannerAbbrv),5))])):((0,o.openBlock)(),(0,o.createElementBlock)("div",y,(0,o.toDisplayString)(a.id.slice(0,1).toUpperCase()),1))]))]),(0,o.createElementVNode)("div",f,[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["title",{"with-description":!!a.description}])},[(0,o.createElementVNode)("h5",null,[e.$store.getters["i18n/exists"](a.label)?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("span",b,null,512)),[[z,e.t(a.label)]]):((0,o.openBlock)(),(0,o.createElementBlock)("span",k,(0,o.toDisplayString)(a.label),1))]),a.docLink?((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:0,href:a.docLink,target:"_blank",rel:"noopener nofollow",class:"flex-right"},[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("generic.moreInfo"))+" ",1),t[8]||(t[8]=(0,o.createElementVNode)("i",{class:"icon icon-external-link"},null,-1))],8,v)):(0,o.createCommentVNode)("",!0)],2),a.description?((0,o.openBlock)(),(0,o.createElementBlock)("hr",w)):(0,o.createCommentVNode)("",!0),a.description?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[e.$store.getters["i18n/exists"](a.description)?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("span",S,null,512)),[[z,e.t(a.description,{},!0)]]):((0,o.openBlock)(),(0,o.createElementBlock)("span",C,(0,o.toDisplayString)(a.description),1))])):(0,o.createCommentVNode)("",!0)])])]),!0)],42,n)))),128))]),!0)])):(0,o.createCommentVNode)("",!0),O.showAsForm&&s.steps.length?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[T._selectedSubtype||!s.subtypes.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",B,[s.resource?((0,o.openBlock)(),(0,o.createBlock)(M,{key:0,ref:"Wizard","header-mode":s.mode,steps:s.steps,"edit-first-step":s.stepsOptions.editFirstStep,errors:s.errors,"finish-mode":s.finishMode,class:"wizard",onError:t[2]||(t[2]=e=>s.errors=e)},{stepContainer:(0,o.withCtx)((({activeStep:t})=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.steps,((s,a)=>((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:a},[s.name===t.name||s.hidden?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:s.name,class:(0,o.normalizeClass)(["step-container__step",{hide:s.name!==t.name&&s.hidden}])},[(0,o.renderSlot)(e.$slots,s.name,{step:s},void 0,!0)],2)):(0,o.createCommentVNode)("",!0)],64)))),128))])),controlsContainer:(0,o.withCtx)((({showPrevious:a,next:r,back:i,activeStep:l,canNext:n,activeStepIndex:c,visibleSteps:d})=>[(0,o.createVNode)(I,{class:"cru__footer",mode:s.mode,"is-form":O.showAsForm,"show-cancel":s.showCancel,onCancelConfirmed:T.confirmCancel},(0,o.createSlots)({default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",E,[T.showYaml?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn role-secondary",onClick:t[0]||(t[0]=(...e)=>T.showPreviewYaml&&T.showPreviewYaml(...e))},[(0,o.createVNode)(F,{k:"cruResource.previewYaml"})])):(0,o.createCommentVNode)("",!0),a?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,type:"button",class:"btn role-secondary",onClick:e=>i()},[(0,o.createVNode)(F,{k:"wizard.previous"})],8,_)):(0,o.createCommentVNode)("",!0),c===d.length-1?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[T.showSubtypeSelection||T.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(j,{key:0,ref:"save",disabled:!l.ready,mode:s.finishButtonMode||s.mode,onClick:t[1]||(t[1]=t=>e.$emit("finish",t))},null,8,["disabled","mode"]))],64)):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:3,disabled:!n,type:"button",class:"btn role-primary",onClick:e=>r()},[(0,o.createVNode)(F,{k:"wizard.next"})],8,N))])])),_:2},[(0,o.renderList)(e.$slots,((t,s)=>({name:s,fn:(0,o.withCtx)((t=>[T.shouldProvideSlot(s)?(0,o.renderSlot)(e.$slots,s,(0,o.normalizeProps)((0,o.mergeProps)({key:0},t)),void 0,!0):(0,o.createCommentVNode)("",!0)]))})))]),1032,["mode","is-form","show-cancel","onCancelConfirmed"])])),_:3},8,["header-mode","steps","edit-first-step","errors","finish-mode"])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0)],64)):O.showAsForm?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:3},[T._selectedSubtype||!s.subtypes.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,class:"resource-container cru__content",style:(0,o.normalizeStyle)([s.minHeight?{"min-height":s.minHeight}:{}])},[(0,o.renderSlot)(e.$slots,"default",{},void 0,!0)],4)):(0,o.createCommentVNode)("",!0),(0,o.renderSlot)(e.$slots,"form-footer",{},(()=>[(0,o.createVNode)(I,{class:"cru__footer",mode:s.mode,"is-form":O.showAsForm,"show-cancel":s.showCancel,"component-testid":s.componentTestid,onCancelConfirmed:T.confirmCancel},(0,o.createSlots)({_:2},[(0,o.renderList)(e.$slots,((t,s)=>({name:s,fn:(0,o.withCtx)((t=>[T.shouldProvideSlot(s)?(0,o.renderSlot)(e.$slots,s,(0,o.normalizeProps)((0,o.mergeProps)({key:0},t)),void 0,!0):(0,o.createCommentVNode)("",!0)]))}))),T.isView?void 0:{name:"default",fn:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[T.showYaml?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,"data-testid":s.componentTestid+"-yaml",type:"button",class:"btn role-secondary",onClick:t[3]||(t[3]=(...e)=>T.showPreviewYaml&&T.showPreviewYaml(...e))},[(0,o.createVNode)(F,{k:"cruResource.previewYaml"})],8,A)):(0,o.createCommentVNode)("",!0),T.showSubtypeSelection?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(j,{key:1,ref:"save",disabled:!T.canSave,mode:s.finishButtonMode||s.mode,"data-testid":s.componentTestid+"-save",onClick:t[4]||(t[4]=e=>T.clickSave(e))},null,8,["disabled","mode","data-testid"]))])])),key:"0"}]),1032,["mode","is-form","show-cancel","component-testid","onCancelConfirmed"])]),!0)],64)):T.showYaml&&!O.showAsForm?((0,o.openBlock)(),(0,o.createElementBlock)("section",$,[(0,o.createVNode)(L,{ref:"resourceyaml",value:s.resource,mode:s.mode,"initial-yaml-for-diff":O.initialYaml,yaml:O.resourceYaml,"offer-preview":T.isEdit,"done-route":s.doneRoute,"done-override":s.resource.doneOverride,"show-errors":!1,"apply-hooks":s.applyHooks,class:"resource-container cru__content",onError:t[5]||(t[5]=t=>e.$emit("error",t))},{yamlFooter:(0,o.withCtx)((({yamlSave:t,showPreview:a,yamlPreview:r,yamlUnpreview:i,canDiff:l})=>[(0,o.renderSlot)(e.$slots,"cru-yaml-footer",{},(()=>[(0,o.createVNode)(I,{class:"cru__footer","done-route":s.doneRoute,mode:s.mode,"is-form":O.showAsForm,onCancelConfirmed:T.confirmCancel},{default:(0,o.withCtx)((({checkCancel:n})=>[(0,o.createElementVNode)("div",x,[a?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn role-secondary","data-testid":s.componentTestid+"-yaml-yaml",onClick:i},[(0,o.createVNode)(F,{k:"resourceYaml.buttons.continue"})],8,K)):(0,o.createCommentVNode)("",!0),!a&&T.isEdit?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,"data-testid":s.componentTestid+"-yaml-yaml-preview",disabled:!l,type:"button",class:"btn role-secondary",onClick:r},[(0,o.createVNode)(F,{k:"resourceYaml.buttons.diff"})],8,V)):(0,o.createCommentVNode)("",!0)]),T._selectedSubtype||!s.subtypes.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",Y,[(0,o.createElementVNode)("button",{"data-testid":s.componentTestid+"-yaml-cancel",type:"button",class:"btn role-secondary",onClick:e=>n(!1)},[(0,o.createVNode)(F,{k:"cruResource.backToForm"})],8,H),T.showSubtypeSelection?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(j,{key:0,"data-testid":s.componentTestid+"-yaml-save",disabled:!T.canSave,"action-label":T.isEdit?e.t("generic.save"):e.t("generic.create"),onClick:e=>t(e)},null,8,["data-testid","disabled","action-label","onClick"]))])):(0,o.createCommentVNode)("",!0)])),_:2},1032,["done-route","mode","is-form","onCancelConfirmed"])]),!0)])),_:3},8,["value","mode","initial-yaml-for-diff","yaml","offer-preview","done-route","done-override","apply-hooks"])])):(0,o.createCommentVNode)("",!0)])),_:3},40,["value"]))])}var O=s(3514),T=s.n(O),D=s(52946),F=s(76978),j=s(35664),I=s(40103),M=s(9980),L=s(67607),z=s(65359),U=s(99726);const P={class:"cru-resource-footer"},q=["data-testid"];function G(e,t,s,a,r,i){const l=(0,o.resolveComponent)("t"),n=(0,o.resolveComponent)("AsyncButton"),c=(0,o.resolveComponent)("ResourceCancelModal");return(0,o.openBlock)(),(0,o.createElementBlock)("div",P,[(0,o.renderSlot)(e.$slots,"footer-prefix"),(0,o.renderSlot)(e.$slots,"cancel",{},(()=>[!i.isView&&s.showCancel?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,id:"cru-cancel","data-testid":s.componentTestid+"-cancel",type:"button",class:"btn role-secondary",onClick:t[0]||(t[0]=t=>s.confirmCancelRequired?i.checkCancel(!0):e.$emit("cancel-confirmed",!0))},[(0,o.createVNode)(l,{k:"generic.cancel"})],8,q)):(0,o.createCommentVNode)("",!0)])),(0,o.renderSlot)(e.$slots,"default",{checkCancel:i.checkCancel},(()=>[i.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(n,{key:0,"data-testid":s.componentTestid+"-create",mode:s.finishButtonMode||s.mode,onClick:t[1]||(t[1]=t=>e.$emit("finish",t))},null,8,["data-testid","mode"]))])),(0,o.createVNode)(c,{ref:"cancelModal","is-cancel-modal":r.isCancelModal,"is-form":s.isForm,onConfirmCancel:t[2]||(t[2]=e=>i.confirmCancel(e))},null,8,["is-cancel-modal","is-form"])])}var J=s(92844),W=s(14220),Q={emits:["cancel-confirmed","finish"],components:{AsyncButton:L.A,ResourceCancelModal:J.A},props:{mode:{type:String,default:"create"},isForm:{type:Boolean,default:!0},finishButtonMode:{type:String,default:null},confirmCancelRequired:{type:Boolean,default:!1},confirmBackRequired:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},componentTestid:{type:String,default:"form-footer"}},data(){return{isCancelModal:!1}},computed:{...(0,z.L8)({t:"i18n/t"}),isView(){return this.mode===W.nW}},methods:{checkCancel(e){this.isCancelModal=!!e,this.$refs.cancelModal.show()},confirmCancel(e){this.$emit("cancel-confirmed",e)}}},X=(s(21255),s(47433));const Z=(0,X.A)(Q,[["render",G]]);var ee=Z,te=s(8135),se=s(17340),oe=s(4364);const ae="show-preview-yaml";var re={name:"CruResource",emits:["select-type","error","cancel","finish"],components:{AsyncButton:L.A,Banner:M.l,CruResourceFooter:ee,ResourceYaml:I.A,Wizard:se.A},props:{doneRoute:{type:[String,Object],default:null},cancelEvent:{type:Boolean,default:!1},showCancel:{type:Boolean,default:!0},mode:{type:String,required:!0},resource:{type:[String,Object],required:!0},subtypes:{type:Array,default:()=>[]},selectedSubtype:{type:String,default:null},validationPassed:{type:Boolean,default:!0},errors:{type:Array,default:()=>[]},errorsMap:{type:Object,default:null},canYaml:{type:Boolean,default:!0},generateYaml:{type:Function,default:null},finishButtonMode:{type:String,default:null},preventEnterSubmit:{type:Boolean,default:!1},applyHooks:{type:Function,default:null},steps:{type:Array,default:()=>[]},stepsOptions:{type:Object,default:()=>({editFirstStep:!0})},finishMode:{type:String,default:"finish"},minHeight:{type:String,default:""},namespaceKey:{type:String,default:"metadata.namespace"},componentTestid:{type:String,default:"form"},description:{type:String,default:""},yamlModifiers:{type:Object,default:void 0}},data(e){const t=this.$store.getters["currentStore"](this.resource),s=this.$store.getters[`${t}/schemaFor`](this.resource.type);return{isCancelModal:!1,showAsForm:this.$route.query[W.AS]!==W.zD,resourceYaml:null,initialYaml:null,initialResource:(0,F.o8)(this.resource),abbrSizes:{3:"24px",4:"18px",5:"16px",6:"14px"},schema:s}},computed:{canSave(){const{validationPassed:e,showAsForm:t,steps:s}=this;return t&&s?.length?e&&this.steps.every((e=>e.ready)):!this.showAsForm||this.validationPassed},canEditYaml(){return!this.schema?.resourceMethods?.includes("blocked-PUT")},showYaml(){return this.canYaml&&(this._selectedSubtype||!this.subtypes.length)&&this.canEditYaml&&this.mode!==W.nW},isView(){return this.mode===W.nW},isEdit(){return this.mode===W.G5},_selectedSubtype(){return this.selectedSubtype?this.selectedSubtype:this.$route.query[W.UA]},showSubtypeSelection(){return!T()(this.subtypes)&&!this._selectedSubtype},...(0,z.L8)({t:"i18n/t"}),...(0,z.aH)("cru-resource",["createNamespace"]),...(0,z.i0)("cru-resource",["setCreateNamespace"]),hasErrors(){return this.errors?.length&&Array.isArray(this.errors)},mappedErrors(){return this.errors?this.errorsMap||this.errors.reduce(((e,t)=>({...e,[t]:{message:this.formatError(t),icon:null}})),{}):{}}},created(){this._selectedSubtype&&this.$emit("select-type",this._selectedSubtype)},mounted(){this.$store.dispatch("cru-resource/setCreateNamespace",!1)},beforeUnmount(){this.$store.dispatch("cru-resource/setCreateNamespace",!1)},methods:{stringify:U.As,confirmCancel(e=!0){e?this.emitOrRoute():this.showAsForm||(this.resourceYaml=null,this.showAsForm=!0,this.$router.applyQuery({[W.AS]:W.xz}))},closeError(e){const t=this.errors.filter(((t,s)=>s!==e));this.$emit("error",t,this.errors[e])},emitOrRoute(){if(this.cancelEvent)this.$emit("cancel");else{const{resource:e=this.resource.type}=this.$route.params,t=this.resource.doneOverride,s={name:this.doneRoute,params:{resource:e}};this.$router.replace(t||s)}},async createResourceYaml(e,t=this.resource){if(await(this.schema?.fetchResourceFields()),"function"===typeof this.generateYaml)return this.generateYaml.apply(this,t);{const s=this.$store.getters["currentStore"](t),o=this.$store.getters[`${s}/all`](j.yx),a=(0,F.o8)(t),r=(0,D.Yd)(o,t.type,a,e);return r}},async showPreviewYaml(){if(await(this.schema?.fetchResourceFields()),this.applyHooks)try{await this.applyHooks(te.Fm,ae)}catch(t){return void oe.warn("Unable to show yaml: ",t)}const e=await this.createResourceYaml(this.yamlModifiers);this.resourceYaml=e,this.showAsForm=!1,this.$router.applyQuery({[W.AS]:W.zD})},selectType(e,t){"A"!==t?.srcElement?.tagName&&(this.$router.applyQuery({[W.UA]:e}),this.$emit("select-type",e))},async clickSave(e){if(this.createNamespace)try{await this.createNamespaceIfNeeded()}catch(t){return this.$emit("error",(0,U.rz)(t.message)),void e(!1)}this.$emit("finish",e)},save(){this.$refs.save.clicked()},async createNamespaceIfNeeded(){const e=this.$store.getters["currentStore"](this.resource),t=(0,F.Jt)(this.resource,this.namespaceKey);let s=!1;try{s=!!await this.$store.dispatch(`${e}/find`,{type:j.CU,id:t})}catch{}if(!s)try{const s=await this.$store.dispatch(`${e}/createNamespace`,{name:t},{root:!0});s.applyDefaults(),await s.save()}catch(o){throw this.$emit("error",(0,U.rz)(o)),new Error(`Could not create the new namespace. ${o.message}`)}},onPressEnter(e){this.preventEnterSubmit&&e.preventDefault()},shouldProvideSlot(e){return"default"!==e&&"function"===typeof this.$slots[e]},formatError(e){if("string"===typeof e)return e;if("ActionNotAvailable"===e?.code)return this.t("errors.actionNotAvailable");const t=e?.message?e.message:"";let s="";if(e?.message&&e.detail)s=this.t("errors.messageAndDetail",{message:e.message,detail:e.detail});else if(e?.message||e.detail){const t=e.message?e.message:e.detail;s=this.t("errors.messageOrDetail",{val:t})}if(422===e?.status){const t=e?.fieldName,o=e?.code;let a="";switch(e?.code){case"MissingRequired":a=this.t("errors.missingRequired");break;case"NotUnique":a=this.t("errors.notUnique");break;case"NotNullable":a=this.t("errors.notNullable");break;case"InvalidOption":a=this.t("errors.invalidOption");break;case"InvalidCharacters":a=this.t("errors.invalidCharacters");break;case"MinLengthExceeded":a=this.t("errors.minLengthExceeded");break;case"MaxLengthExceeded":a=this.t("errors.maxLengthExceeded");break;case"MinLimitExceeded":a=this.t("errors.minLimitExceeded");break;case"MaxLimitExceded":a=this.t("errors.maxLimitExceded");break}return t?a?s?this.t("errors.failedInApi.withName.withCodeExplanation.withMessageDetail",{name:t,codeExplanation:a,messageDetail:s}):this.t("errors.failedInApi.withName.withCodeExplanation.withoutMessageDetail",{name:t,codeExplanation:a}):s?this.t("errors.failedInApi.withName.withMessageDetail",{name:t,messageDetail:s}):this.t("errors.failedInApi.withName.withoutAnythingElse",{name:t}):s?a?this.t("errors.failedInApi.withoutName.withMessageDetail.withCodeExplanation",{codeExplanation:a,messageDetail:s}):this.t("errors.failedInApi.withoutName.withMessageDetail.withoutCodeExplanation",{messageDetail:s}):o?a?this.t("errors.failedInApi.withoutName.withCode.withCodeExplanation",{code:o,codeExplanation:a}):this.t("errors.failedInApi.withoutName.withCode.withoutCodeExplanation",{code:o}):this.t("errors.failedInApi.withoutAnything")}return 404===e?.status?e?.opt?.url?this.t("errors.notFound.withUrl",{msg:t,url:e.opt.url}):this.t("errors.notFound.withoutUrl",{msg:t}):s.length>0?s:e}},watch:{async showAsForm(e){e||this.initialYaml||(this.initialYaml=await this.createResourceYaml(void 0,this.initialResource))}}};s(51384);const ie=(0,X.A)(re,[["render",R],["__scopeId","data-v-0bb22665"]]);var le=ie},17259:function(e,t,s){"use strict";s.d(t,{J:function(){return o}});const o={OPAQUE:"Opaque",SERVICE_ACCT:"kubernetes.io/service-account-token",DOCKER_JSON:"kubernetes.io/dockerconfigjson",BASIC:"kubernetes.io/basic-auth",SSH:"kubernetes.io/ssh-auth",TLS:"kubernetes.io/tls",BOOTSTRAP:"bootstrap.kubernetes.io/token",ISTIO_TLS:"istio.io/key-and-cert",HELM_RELEASE:"helm.sh/release.v1",FLEET_CLUSTER:"fleet.cattle.io/cluster-registration-values",CLOUD_CREDENTIAL:"provisioning.cattle.io/cloud-credential",RKE_AUTH_CONFIG:"rke.cattle.io/auth-config",FLEET_OCI_STORAGE:"fleet.cattle.io/bundle-oci-storage/v1alpha1"}},21255:function(e,t,s){var o=s(3367);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(74825).A;a("631276d2",o,!0,{sourceMap:!1,shadowMode:!1})},45044:function(e,t,s){var o=s(85908);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(74825).A;a("8b2d3ca0",o,!0,{sourceMap:!1,shadowMode:!1})},46820:function(e,t,s){"use strict";s.r(t);var o=s(36758),a=s.n(o),r=s(40935),i=s.n(r),l=i()(a());l.push([e.id,".select-or-create-auth-secret div.labeled-select{min-height:61px}",""]),t["default"]=l},47864:function(e,t,s){"use strict";s.r(t);var o=s(36758),a=s.n(o),r=s(40935),i=s.n(r),l=i()(a());l.push([e.id,".cru-resource-yaml-container .resource-yaml .yaml-editor[data-v-0bb22665]{min-height:100px}.create-resource-container .resource-container[data-v-0bb22665]{display:flex;flex-direction:column}.create-resource-container .subtype-banner .round-image[data-v-0bb22665]{background-color:var(--primary)}.create-resource-container .subtype-banner[data-v-0bb22665]:focus-visible{outline:2px solid var(--primary-keyboard-focus)}.title[data-v-0bb22665]{margin-top:20px}.title.with-description[data-v-0bb22665]{margin-top:0}.subtype-container[data-v-0bb22665]{position:relative;display:flex;height:100%}.subtype-body[data-v-0bb22665]{flex:1;padding:10px}.subtype-logo[data-v-0bb22665]{align-items:center;display:flex;justify-content:center;min-width:100px;min-height:100px;overflow:hidden;background-color:var(--box-bg)}.subtype-logo img[data-v-0bb22665]{width:56px;height:56px;-o-object-fit:contain;object-fit:contain;position:relative;top:2px}form.create-resource-container .cru__footer[data-v-0bb22665]{border-top:var(--header-border-size) solid var(--header-border)}.cru[data-v-0bb22665],.cru__form[data-v-0bb22665]{display:flex;flex-direction:column;flex-grow:1}.cru__content[data-v-0bb22665]{flex-grow:1}.cru__content-wizard[data-v-0bb22665]{display:flex}.cru__footer[data-v-0bb22665]{right:0;bottom:0;height:60px;box-sizing:border-box;margin-left:-24px;margin-right:-24px;margin-bottom:-24px;padding:10px 24px}.cru__errors[data-v-0bb22665],.cru__footer[data-v-0bb22665]{position:sticky;background-color:var(--header-bg)}.cru__errors[data-v-0bb22665]{top:0;z-index:1;margin:10px 0}.description[data-v-0bb22665]{margin-bottom:15px;margin-top:5px}",""]),t["default"]=l},51384:function(e,t,s){var o=s(47864);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=s(74825).A;a("6f753afc",o,!0,{sourceMap:!1,shadowMode:!1})},67198:function(e,t,s){"use strict";s.d(t,{A:function(){return A}});var o=s(9274);const a={class:"select-or-create-auth-secret"},r={key:0,class:"col span-2"};function i(e,t,s,i,l,n){const c=(0,o.resolveComponent)("LabeledSelect"),d=(0,o.resolveComponent)("LabeledInput"),u=(0,o.resolveComponent)("SSHKnownHosts"),p=(0,o.resolveComponent)("Banner");return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["mt-20",{row:!s.vertical}])},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.firstCol)},[(0,o.createVNode)(c,{value:l.selected,"onUpdate:value":t[0]||(t[0]=e=>l.selected=e),"data-testid":"auth-secret-select",mode:s.mode,"label-key":s.labelKey,loading:e.$fetchState.pending,options:n.options,selectable:e=>!e.disabled},null,8,["value","mode","label-key","loading","options","selectable"])],2),l.selected===l.SSH?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.moreCols)},[(0,o.createVNode)(d,{value:l.publicKey,"onUpdate:value":t[1]||(t[1]=e=>l.publicKey=e),"data-testid":"auth-secret-ssh-public-key",mode:s.mode,type:"multiline","label-key":"selectOrCreateAuthSecret.ssh.publicKey"},null,8,["value","mode"])],2),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.moreCols)},[(0,o.createVNode)(d,{value:l.privateKey,"onUpdate:value":t[2]||(t[2]=e=>l.privateKey=e),"data-testid":"auth-secret-ssh-private-key",mode:s.mode,type:"multiline","label-key":"selectOrCreateAuthSecret.ssh.privateKey"},null,8,["value","mode"])],2),s.showSshKnownHosts?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(u,{value:l.sshKnownHosts,"onUpdate:value":t[3]||(t[3]=e=>l.sshKnownHosts=e),"data-testid":"auth-secret-known-ssh-hosts",mode:s.mode},null,8,["value","mode"])])):(0,o.createCommentVNode)("",!0)],64)):l.selected===l.BASIC||l.selected===l.RKE?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[l.selected===l.RKE?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,color:"info",class:(0,o.normalizeClass)(n.moreCols)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("selectOrCreateAuthSecret.rke.info",{},!0)),1)])),_:1},8,["class"])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.moreCols)},[(0,o.createVNode)(d,{value:l.publicKey,"onUpdate:value":t[4]||(t[4]=e=>l.publicKey=e),"data-testid":"auth-secret-basic-username",mode:s.mode,"label-key":"selectOrCreateAuthSecret.basic.username"},null,8,["value","mode"])],2),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.moreCols)},[(0,o.createVNode)(d,{value:l.privateKey,"onUpdate:value":t[5]||(t[5]=e=>l.privateKey=e),"data-testid":"auth-secret-basic-password",mode:s.mode,type:"password","label-key":"selectOrCreateAuthSecret.basic.password"},null,8,["value","mode"])],2)],64)):l.selected===l.S3?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.moreCols)},[(0,o.createVNode)(d,{value:l.publicKey,"onUpdate:value":t[6]||(t[6]=e=>l.publicKey=e),"data-testid":"auth-secret-s3-public-key",mode:s.mode,"label-key":"selectOrCreateAuthSecret.s3.accessKey"},null,8,["value","mode"])],2),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(n.moreCols)},[(0,o.createVNode)(d,{value:l.privateKey,"onUpdate:value":t[7]||(t[7]=e=>l.privateKey=e),"data-testid":"auth-secret-s3-private-key",mode:s.mode,type:"password","label-key":"selectOrCreateAuthSecret.s3.secretKey"},null,8,["value","mode"])],2)],64)):(0,o.createCommentVNode)("",!0)],2)])}var l=s(14220),n=s(9980),c=s(22128),d=s(40089);const u={class:"input-known-ssh-hosts labeled-input","data-testid":"input-known-ssh-hosts"},p={class:"hosts-input","data-testid":"input-known-ssh-hosts_summary"},h=["aria-label"],m=["alt"];function y(e,t,s,a,r,i){return(0,o.openBlock)(),(0,o.createElementBlock)("div",u,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(e.t("secret.ssh.knownHosts")),1),(0,o.createElementVNode)("div",p,(0,o.toDisplayString)(e.summary),1),e.isViewMode?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,id:"known-ssh-hosts-trigger",ref:"button",role:"button","aria-label":e.t("secret.ssh.editKnownHosts.title"),"data-testid":"input-known-ssh-hosts_open-dialog",class:"show-dialog-btn btn",onClick:t[0]||(t[0]=(...t)=>e.openDialog&&e.openDialog(...t))},[(0,o.createElementVNode)("i",{class:"icon icon-edit",alt:e.t("secret.ssh.editKnownHosts.title")},null,8,m)],8,h))])}var f=(0,o.defineComponent)({name:"SSHKnownHosts",emits:["update:value"],props:{value:{type:String,required:!0},mode:{type:String,default:l.G5}},computed:{isViewMode(){return this.mode===l.nW},entries(){return this.value.split("\n").filter((e=>!!e.trim().length&&!e.startsWith("#"))).length},summary(){return this.t("secret.ssh.editKnownHosts.entries",{entries:this.entries})}},methods:{openDialog(){this.$refs.button?.blur(),this.$store.dispatch("management/promptModal",{component:"KnownHostsEditDialog",returnFocusSelector:"#known-ssh-hosts-trigger",testId:"sshKnownHostsDialog",height:"auto",componentProps:{mode:this.mode,value:this.value,closed:e=>{this.dialogClosed(e)}}})},dialogClosed(e){e.success&&this.$emit("update:value",e.value)}}}),b=(s(45044),s(47433));const k=(0,b.A)(f,[["render",y],["__scopeId","data-v-446749fc"]]);var v=k,w=s(35664),g=s(17259),S=s(82331),C=s(68851),B=s(74302),E=s(50025),_={name:"SelectOrCreateAuthSecret",emits:["inputauthval","update:value"],components:{Banner:n.l,LabeledInput:c.o,LabeledSelect:d.A,SSHKnownHosts:v},props:{mode:{type:String,default:l.G5},preSelect:{type:Object,default:null},value:{type:[String,Object],default:null},inStore:{type:String,default:"cluster"},labelKey:{type:String,default:"selectOrCreateAuthSecret.label"},namespace:{type:String,required:!0},limitToNamespace:{type:Boolean,default:!0},generateName:{type:String,default:"auth-"},allowNone:{type:Boolean,default:!0},allowSsh:{type:Boolean,default:!0},allowBasic:{type:Boolean,default:!0},allowS3:{type:Boolean,default:!1},allowRke:{type:Boolean,default:!1},registerBeforeHook:{type:Function,required:!0},hookName:{type:String,default:"registerAuthSecret"},appendUniqueIdToHook:{type:Boolean,default:!1},hookPriority:{type:Number,default:99},vertical:{type:Boolean,default:!1},delegateCreateToParent:{type:Boolean,default:!1},cacheSecrets:{type:Boolean,default:!1},showSshKnownHosts:{type:Boolean,default:!1}},async fetch(){(this.allowSsh||this.allowBasic||this.allowRke)&&this.$store.getters[`${this.inStore}/schemaFor`](w.bB)&&(this.$store.getters[`${this.inStore}/paginationEnabled`](w.bB)?this.filteredSecrets=await this.filterSecretsByApi():this.allSecrets=await this.$store.dispatch(`${this.inStore}/findAll`,{type:w.bB})),this.allowS3&&this.$store.getters["rancher/canList"](w.k$.CLOUD_CREDENTIAL)?this.$store.getters["rancher/haveAll"](w.k$.CLOUD_CREDENTIAL)?this.allCloudCreds=this.$store.getters["rancher/all"](w.k$.CLOUD_CREDENTIAL):this.allCloudCreds=await this.$store.dispatch("rancher/findAll",{type:w.k$.CLOUD_CREDENTIAL}):this.allCloudCreds=[],this.value||(this.publicKey=this.preSelect?.publicKey||"",this.privateKey=this.preSelect?.privateKey||"",this.sshKnownHosts=this.preSelect?.sshKnownHosts||""),this.updateSelectedFromValue(),this.update()},data(){return{allCloudCreds:[],allSecrets:null,filteredSecrets:null,selected:null,filterByNamespace:this.namespace&&this.limitToNamespace,publicKey:"",privateKey:"",sshKnownHosts:"",uniqueId:(new Date).getTime(),SSH:w.Yj._SSH,BASIC:w.Yj._BASIC,S3:w.Yj._S3,RKE:w.Yj._RKE}},computed:{secretTypes(){const e=[];return this.allowSsh&&e.push(g.J.SSH),this.allowBasic&&e.push(g.J.BASIC),this.allowRke&&e.push(g.J.RKE_AUTH_CONFIG),e},options(){let e=[];this.allSecrets?e=this.allSecrets.filter((e=>!this.filterByNamespace||e.metadata.namespace===this.namespace)).filter((e=>!(this.secretTypes.length&&!this.secretTypes.includes(e._type)))):this.filteredSecrets&&(e=this.filteredSecrets);let t=e.map((e=>{const{dataPreview:t,subTypeDisplay:s,metadata:o,id:a}=e,r=s&&t?`${o.name} (${s}: ${t})`:`${o.name} (${s})`;return{label:r,group:o.namespace,value:a}}));if(this.allowS3){const e=this.allCloudCreds.filter((e=>["aws","s3"].includes(e.provider))).map((e=>({label:`${e.nameDisplay} (${e.providerDisplay})`,group:"Cloud Credentials",value:e.id})));(0,C.cn)(t,e)}if(!this.limitToNamespace&&(t=(0,B.Ul)(t,"group"),t.length)){let e="";for(let s=0;s<t.length;s++)t[s].group!==e&&(e=t[s].group,(0,C.PT)(t,s,{kind:"title",label:this.t("selectOrCreateAuthSecret.namespaceGroup",{name:e}),disabled:!0}),s++)}return t.length&&t.unshift({kind:"title",label:this.t("selectOrCreateAuthSecret.chooseExisting"),disabled:!0}),this.allowNone&&t.unshift({label:this.t("generic.none"),value:w.Yj._NONE}),(this.allowSsh||this.allowS3||this.allowBasic||this.allowRke)&&t.unshift({label:"divider",disabled:!0,kind:"divider"}),this.allowSsh&&t.unshift({label:this.t("selectOrCreateAuthSecret.createSsh"),value:w.Yj._SSH,kind:"highlighted"}),this.allowS3&&t.unshift({label:this.t("selectOrCreateAuthSecret.createS3"),value:w.Yj._S3,kind:"highlighted"}),this.allowBasic&&t.unshift({label:this.t("selectOrCreateAuthSecret.createBasic"),value:w.Yj._BASIC,kind:"highlighted"}),this.allowRke&&t.unshift({label:this.t("selectOrCreateAuthSecret.createRKE"),value:w.Yj._RKE,kind:"highlighted"}),t},firstCol(){return this.vertical?"":this.selected===w.Yj._SSH||this.selected===w.Yj._BASIC||this.selected===w.Yj._RKE||this.selected===w.Yj._S3?"col span-4":"col span-6"},moreCols(){return this.vertical?"mt-20":this.selected===w.Yj._SSH&&this.showSshKnownHosts?"col span-3":"col span-4"}},watch:{selected:"update",publicKey:"updateKeyVal",privateKey:"updateKeyVal",sshKnownHosts:"updateKeyVal",value:"updateSelectedFromValue",async namespace(e){e&&!this.selected.startsWith(`${e}/`)&&(this.selected=w.Yj._NONE),this.filteredSecrets&&this.filterByNamespace&&(this.filteredSecrets=await this.filterSecretsByApi())}},created(){if(!this.registerBeforeHook)throw new Error("Before Hook is missing");{const e=this.appendUniqueIdToHook?this.hookName+this.uniqueId:this.hookName;this.delegateCreateToParent||this.registerBeforeHook(this.doCreate,e,this.hookPriority)}},methods:{updateSelectedFromValue(){let e=this.preSelect?.selected||w.Yj._NONE;this.value&&(e="object"===typeof this.value?`${this.value.namespace}/${this.value.name}`:this.value.includes("/")||this.value.includes(":")?this.value:this.namespace?`${this.namespace}/${this.value}`:this.value),this.selected=e},async filterSecretsByApi(){const e={namespaced:this.filterByNamespace?this.namespace:"",pagination:new E.YU({filters:[E.eY.createMultipleFields(this.secretTypes.map((e=>new E.Js({field:"metadata.fields.1",value:e}))))]}),watch:this.cacheSecrets};if(this.cacheSecrets)return await this.$store.dispatch(`${this.inStore}/findPage`,{type:w.bB,opt:e});const t=this.$store.getters[`${this.inStore}/urlFor`](w.bB,null,e),s=await this.$store.dispatch(`${this.inStore}/request`,{url:t});return await this.$store.dispatch(`${this.inStore}/createMany`,s?.data||[])},updateKeyVal(){[w.Yj._SSH,w.Yj._BASIC,w.Yj._S3,w.Yj._RKE].includes(this.selected)||(this.privateKey="",this.publicKey="",this.sshKnownHosts="");const e={selected:this.selected,privateKey:this.privateKey,publicKey:this.publicKey};this.sshKnownHosts&&(e.sshKnownHosts=this.sshKnownHosts),this.$emit("inputauthval",e)},update(){if(!this.selected||[w.Yj._SSH,w.Yj._BASIC,w.Yj._S3,w.Yj._RKE,w.Yj._NONE].includes(this.selected))this.$emit("update:value",null);else if(this.selected.includes(":"))this.$emit("update:value",this.selected);else{const e=this.selected.split("/");if(this.limitToNamespace)this.$emit("update:value",e[1]);else{const t={namespace:e[0],name:e[1]};this.$emit("update:value",t)}}this.updateKeyVal()},async doCreate(){if(![w.Yj._SSH,w.Yj._BASIC,w.Yj._S3,w.Yj._RKE].includes(this.selected)||this.delegateCreateToParent)return;let e;if(this.selected===w.Yj._S3)e=await this.$store.dispatch("rancher/create",{type:w.k$.CLOUD_CREDENTIAL,s3credentialConfig:{accessKey:this.publicKey,secretKey:this.privateKey}});else{let t,s,o;switch(e=await this.$store.dispatch(`${this.inStore}/create`,{type:w.bB,metadata:{namespace:this.namespace,generateName:this.generateName}}),this.selected){case w.Yj._SSH:t=g.J.SSH,s="ssh-publickey",o="ssh-privatekey";break;case w.Yj._BASIC:t=g.J.BASIC,s="username",o="password";break;case w.Yj._RKE:t=g.J.RKE_AUTH_CONFIG,e.data={auth:(0,S.KA)(`${this.publicKey}:${this.privateKey}`)};break;default:throw new Error("Unknown type")}e._type=t,e.data||(e.data={[s]:(0,S.KA)(this.publicKey),[o]:(0,S.KA)(this.privateKey)},this.selected===w.Yj._SSH&&this.showSshKnownHosts&&(e.data.known_hosts=(0,S.KA)(this.sshKnownHosts||"")))}return await e.save(),await this.$nextTick((()=>{this.selected=e.id})),e}}};s(10852);const N=(0,b.A)(_,[["render",i]]);var A=N},85908:function(e,t,s){"use strict";s.r(t);var o=s(36758),a=s.n(o),r=s(40935),i=s.n(r),l=i()(a());l.push([e.id,".input-known-ssh-hosts[data-v-446749fc]{display:flex;justify-content:space-between}.input-known-ssh-hosts .hosts-input[data-v-446749fc]{cursor:default;line-height:19px;padding:18px 0 0 0}.input-known-ssh-hosts .show-dialog-btn[data-v-446749fc]{background-color:transparent;padding:4px;height:22px;margin:-3px -3px 0 0;min-height:unset}.input-known-ssh-hosts .show-dialog-btn[data-v-446749fc]:focus-visible{outline:2px solid var(--primary-keyboard-focus);outline-offset:1px}",""]),t["default"]=l},91825:function(e,t,s){"use strict";var o=s(14220),a=s(9274),r=s(65375);t.A=(0,a.defineComponent)({...r.A,props:{mode:{type:String,default:o.G5},realMode:{type:String,default:o.G5},as:{type:String,default:o.zD},value:{type:Object,required:!0},initialValue:{type:Object,default:null},liveValue:{type:Object,default:null},doneEvent:{type:Boolean,default:!1},useTabbedHash:{type:Boolean,default:void 0}}})}}]);
//# sourceMappingURL=sbombastic-image-vulnerability-scanner-0.1.0.umd.min.895.js.map